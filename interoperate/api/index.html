<!doctype html>
<html data-n-head-ssr>
  <head>
    <title>DataFair</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="application" name="application-name" content="DataFair"><meta data-n-head="ssr" data-hid="description" name="description" content="DataFair - Documentation"><meta data-n-head="ssr" data-hid="robots" name="robots" content="index"><link data-n-head="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,400,500,700,400italic|Material+Icons"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="favicon.ico"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Nunito:100,300,400,500,700,900&display=swap"><link data-n-head="ssr" rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css"><style data-n-head="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">.v-application a{color:#1e88e5}.v-application .primary{background-color:#1e88e5!important;border-color:#1e88e5!important}.v-application .primary--text{color:#1e88e5!important;caret-color:#1e88e5!important}.v-application .primary.lighten-5{background-color:#cfffff!important;border-color:#cfffff!important}.v-application .primary--text.text--lighten-5{color:#cfffff!important;caret-color:#cfffff!important}.v-application .primary.lighten-4{background-color:#b0f5ff!important;border-color:#b0f5ff!important}.v-application .primary--text.text--lighten-4{color:#b0f5ff!important;caret-color:#b0f5ff!important}.v-application .primary.lighten-3{background-color:#91d8ff!important;border-color:#91d8ff!important}.v-application .primary--text.text--lighten-3{color:#91d8ff!important;caret-color:#91d8ff!important}.v-application .primary.lighten-2{background-color:#70bdff!important;border-color:#70bdff!important}.v-application .primary--text.text--lighten-2{color:#70bdff!important;caret-color:#70bdff!important}.v-application .primary.lighten-1{background-color:#4da2ff!important;border-color:#4da2ff!important}.v-application .primary--text.text--lighten-1{color:#4da2ff!important;caret-color:#4da2ff!important}.v-application .primary.darken-1{background-color:#006fc9!important;border-color:#006fc9!important}.v-application .primary--text.text--darken-1{color:#006fc9!important;caret-color:#006fc9!important}.v-application .primary.darken-2{background-color:#0057ad!important;border-color:#0057ad!important}.v-application .primary--text.text--darken-2{color:#0057ad!important;caret-color:#0057ad!important}.v-application .primary.darken-3{background-color:#004092!important;border-color:#004092!important}.v-application .primary--text.text--darken-3{color:#004092!important;caret-color:#004092!important}.v-application .primary.darken-4{background-color:#002b78!important;border-color:#002b78!important}.v-application .primary--text.text--darken-4{color:#002b78!important;caret-color:#002b78!important}.v-application .secondary{background-color:#42a5f5!important;border-color:#42a5f5!important}.v-application .secondary--text{color:#42a5f5!important;caret-color:#42a5f5!important}.v-application .secondary.lighten-5{background-color:#e4ffff!important;border-color:#e4ffff!important}.v-application .secondary--text.text--lighten-5{color:#e4ffff!important;caret-color:#e4ffff!important}.v-application .secondary.lighten-4{background-color:#c5ffff!important;border-color:#c5ffff!important}.v-application .secondary--text.text--lighten-4{color:#c5ffff!important;caret-color:#c5ffff!important}.v-application .secondary.lighten-3{background-color:#a6f8ff!important;border-color:#a6f8ff!important}.v-application .secondary--text.text--lighten-3{color:#a6f8ff!important;caret-color:#a6f8ff!important}.v-application .secondary.lighten-2{background-color:#87dcff!important;border-color:#87dcff!important}.v-application .secondary--text.text--lighten-2{color:#87dcff!important;caret-color:#87dcff!important}.v-application .secondary.lighten-1{background-color:#66c0ff!important;border-color:#66c0ff!important}.v-application .secondary--text.text--lighten-1{color:#66c0ff!important;caret-color:#66c0ff!important}.v-application .secondary.darken-1{background-color:#018bd8!important;border-color:#018bd8!important}.v-application .secondary--text.text--darken-1{color:#018bd8!important;caret-color:#018bd8!important}.v-application .secondary.darken-2{background-color:#0072bc!important;border-color:#0072bc!important}.v-application .secondary--text.text--darken-2{color:#0072bc!important;caret-color:#0072bc!important}.v-application .secondary.darken-3{background-color:#0059a1!important;border-color:#0059a1!important}.v-application .secondary--text.text--darken-3{color:#0059a1!important;caret-color:#0059a1!important}.v-application .secondary.darken-4{background-color:#004286!important;border-color:#004286!important}.v-application .secondary--text.text--darken-4{color:#004286!important;caret-color:#004286!important}.v-application .accent{background-color:#ff9800!important;border-color:#ff9800!important}.v-application .accent--text{color:#ff9800!important;caret-color:#ff9800!important}.v-application .accent.lighten-5{background-color:#ffffa2!important;border-color:#ffffa2!important}.v-application .accent--text.text--lighten-5{color:#ffffa2!important;caret-color:#ffffa2!important}.v-application .accent.lighten-4{background-color:#ffff85!important;border-color:#ffff85!important}.v-application .accent--text.text--lighten-4{color:#ffff85!important;caret-color:#ffff85!important}.v-application .accent.lighten-3{background-color:#ffeb69!important;border-color:#ffeb69!important}.v-application .accent--text.text--lighten-3{color:#ffeb69!important;caret-color:#ffeb69!important}.v-application .accent.lighten-2{background-color:#ffcf4d!important;border-color:#ffcf4d!important}.v-application .accent--text.text--lighten-2{color:#ffcf4d!important;caret-color:#ffcf4d!important}.v-application .accent.lighten-1{background-color:#ffb32f!important;border-color:#ffb32f!important}.v-application .accent--text.text--lighten-1{color:#ffb32f!important;caret-color:#ffb32f!important}.v-application .accent.darken-1{background-color:#df7e00!important;border-color:#df7e00!important}.v-application .accent--text.text--darken-1{color:#df7e00!important;caret-color:#df7e00!important}.v-application .accent.darken-2{background-color:#bf6400!important;border-color:#bf6400!important}.v-application .accent--text.text--darken-2{color:#bf6400!important;caret-color:#bf6400!important}.v-application .accent.darken-3{background-color:#a14c00!important;border-color:#a14c00!important}.v-application .accent--text.text--darken-3{color:#a14c00!important;caret-color:#a14c00!important}.v-application .accent.darken-4{background-color:#843300!important;border-color:#843300!important}.v-application .accent--text.text--darken-4{color:#843300!important;caret-color:#843300!important}.v-application .error{background-color:#ff5252!important;border-color:#ff5252!important}.v-application .error--text{color:#ff5252!important;caret-color:#ff5252!important}.v-application .error.lighten-5{background-color:#ffe4d5!important;border-color:#ffe4d5!important}.v-application .error--text.text--lighten-5{color:#ffe4d5!important;caret-color:#ffe4d5!important}.v-application .error.lighten-4{background-color:#ffc6b9!important;border-color:#ffc6b9!important}.v-application .error--text.text--lighten-4{color:#ffc6b9!important;caret-color:#ffc6b9!important}.v-application .error.lighten-3{background-color:#ffa99e!important;border-color:#ffa99e!important}.v-application .error--text.text--lighten-3{color:#ffa99e!important;caret-color:#ffa99e!important}.v-application .error.lighten-2{background-color:#ff8c84!important;border-color:#ff8c84!important}.v-application .error--text.text--lighten-2{color:#ff8c84!important;caret-color:#ff8c84!important}.v-application .error.lighten-1{background-color:#ff6f6a!important;border-color:#ff6f6a!important}.v-application .error--text.text--lighten-1{color:#ff6f6a!important;caret-color:#ff6f6a!important}.v-application .error.darken-1{background-color:#df323b!important;border-color:#df323b!important}.v-application .error--text.text--darken-1{color:#df323b!important;caret-color:#df323b!important}.v-application .error.darken-2{background-color:#bf0025!important;border-color:#bf0025!important}.v-application .error--text.text--darken-2{color:#bf0025!important;caret-color:#bf0025!important}.v-application .error.darken-3{background-color:#9f0010!important;border-color:#9f0010!important}.v-application .error--text.text--darken-3{color:#9f0010!important;caret-color:#9f0010!important}.v-application .error.darken-4{background-color:maroon!important;border-color:maroon!important}.v-application .error--text.text--darken-4{color:maroon!important;caret-color:maroon!important}.v-application .info{background-color:#2196f3!important;border-color:#2196f3!important}.v-application .info--text{color:#2196f3!important;caret-color:#2196f3!important}.v-application .info.lighten-5{background-color:#d4ffff!important;border-color:#d4ffff!important}.v-application .info--text.text--lighten-5{color:#d4ffff!important;caret-color:#d4ffff!important}.v-application .info.lighten-4{background-color:#b5ffff!important;border-color:#b5ffff!important}.v-application .info--text.text--lighten-4{color:#b5ffff!important;caret-color:#b5ffff!important}.v-application .info.lighten-3{background-color:#95e8ff!important;border-color:#95e8ff!important}.v-application .info--text.text--lighten-3{color:#95e8ff!important;caret-color:#95e8ff!important}.v-application .info.lighten-2{background-color:#75ccff!important;border-color:#75ccff!important}.v-application .info--text.text--lighten-2{color:#75ccff!important;caret-color:#75ccff!important}.v-application .info.lighten-1{background-color:#51b0ff!important;border-color:#51b0ff!important}.v-application .info--text.text--lighten-1{color:#51b0ff!important;caret-color:#51b0ff!important}.v-application .info.darken-1{background-color:#007cd6!important;border-color:#007cd6!important}.v-application .info--text.text--darken-1{color:#007cd6!important;caret-color:#007cd6!important}.v-application .info.darken-2{background-color:#0064ba!important;border-color:#0064ba!important}.v-application .info--text.text--darken-2{color:#0064ba!important;caret-color:#0064ba!important}.v-application .info.darken-3{background-color:#004d9f!important;border-color:#004d9f!important}.v-application .info--text.text--darken-3{color:#004d9f!important;caret-color:#004d9f!important}.v-application .info.darken-4{background-color:#003784!important;border-color:#003784!important}.v-application .info--text.text--darken-4{color:#003784!important;caret-color:#003784!important}.v-application .success{background-color:#4caf50!important;border-color:#4caf50!important}.v-application .success--text{color:#4caf50!important;caret-color:#4caf50!important}.v-application .success.lighten-5{background-color:#dcffd6!important;border-color:#dcffd6!important}.v-application .success--text.text--lighten-5{color:#dcffd6!important;caret-color:#dcffd6!important}.v-application .success.lighten-4{background-color:#beffba!important;border-color:#beffba!important}.v-application .success--text.text--lighten-4{color:#beffba!important;caret-color:#beffba!important}.v-application .success.lighten-3{background-color:#a2ff9e!important;border-color:#a2ff9e!important}.v-application .success--text.text--lighten-3{color:#a2ff9e!important;caret-color:#a2ff9e!important}.v-application .success.lighten-2{background-color:#85e783!important;border-color:#85e783!important}.v-application .success--text.text--lighten-2{color:#85e783!important;caret-color:#85e783!important}.v-application .success.lighten-1{background-color:#69cb69!important;border-color:#69cb69!important}.v-application .success--text.text--lighten-1{color:#69cb69!important;caret-color:#69cb69!important}.v-application .success.darken-1{background-color:#2d9437!important;border-color:#2d9437!important}.v-application .success--text.text--darken-1{color:#2d9437!important;caret-color:#2d9437!important}.v-application .success.darken-2{background-color:#00791e!important;border-color:#00791e!important}.v-application .success--text.text--darken-2{color:#00791e!important;caret-color:#00791e!important}.v-application .success.darken-3{background-color:#006000!important;border-color:#006000!important}.v-application .success--text.text--darken-3{color:#006000!important;caret-color:#006000!important}.v-application .success.darken-4{background-color:#004700!important;border-color:#004700!important}.v-application .success--text.text--darken-4{color:#004700!important;caret-color:#004700!important}.v-application .warning{background-color:#e91e63!important;border-color:#e91e63!important}.v-application .warning--text{color:#e91e63!important;caret-color:#e91e63!important}.v-application .warning.lighten-5{background-color:#ffc0e7!important;border-color:#ffc0e7!important}.v-application .warning--text.text--lighten-5{color:#ffc0e7!important;caret-color:#ffc0e7!important}.v-application .warning.lighten-4{background-color:#ffa3cb!important;border-color:#ffa3cb!important}.v-application .warning--text.text--lighten-4{color:#ffa3cb!important;caret-color:#ffa3cb!important}.v-application .warning.lighten-3{background-color:#ff85b0!important;border-color:#ff85b0!important}.v-application .warning--text.text--lighten-3{color:#ff85b0!important;caret-color:#ff85b0!important}.v-application .warning.lighten-2{background-color:#ff6795!important;border-color:#ff6795!important}.v-application .warning--text.text--lighten-2{color:#ff6795!important;caret-color:#ff6795!important}.v-application .warning.lighten-1{background-color:#ff467c!important;border-color:#ff467c!important}.v-application .warning--text.text--lighten-1{color:#ff467c!important;caret-color:#ff467c!important}.v-application .warning.darken-1{background-color:#c9004b!important;border-color:#c9004b!important}.v-application .warning--text.text--darken-1{color:#c9004b!important;caret-color:#c9004b!important}.v-application .warning.darken-2{background-color:#aa0035!important;border-color:#aa0035!important}.v-application .warning--text.text--darken-2{color:#aa0035!important;caret-color:#aa0035!important}.v-application .warning.darken-3{background-color:#8b0021!important;border-color:#8b0021!important}.v-application .warning--text.text--darken-3{color:#8b0021!important;caret-color:#8b0021!important}.v-application .warning.darken-4{background-color:#6c000a!important;border-color:#6c000a!important}.v-application .warning--text.text--darken-4{color:#6c000a!important;caret-color:#6c000a!important}.v-application .admin{background-color:#e53935!important;border-color:#e53935!important}.v-application .admin--text{color:#e53935!important;caret-color:#e53935!important}.v-application .admin.lighten-5{background-color:#ffccb3!important;border-color:#ffccb3!important}.v-application .admin--text.text--lighten-5{color:#ffccb3!important;caret-color:#ffccb3!important}.v-application .admin.lighten-4{background-color:#ffaf98!important;border-color:#ffaf98!important}.v-application .admin--text.text--lighten-4{color:#ffaf98!important;caret-color:#ffaf98!important}.v-application .admin.lighten-3{background-color:#ff927e!important;border-color:#ff927e!important}.v-application .admin--text.text--lighten-3{color:#ff927e!important;caret-color:#ff927e!important}.v-application .admin.lighten-2{background-color:#ff7565!important;border-color:#ff7565!important}.v-application .admin--text.text--lighten-2{color:#ff7565!important;caret-color:#ff7565!important}.v-application .admin.lighten-1{background-color:#ff584c!important;border-color:#ff584c!important}.v-application .admin--text.text--lighten-1{color:#ff584c!important;caret-color:#ff584c!important}.v-application .admin.darken-1{background-color:#c50f1f!important;border-color:#c50f1f!important}.v-application .admin--text.text--darken-1{color:#c50f1f!important;caret-color:#c50f1f!important}.v-application .admin.darken-2{background-color:#a50009!important;border-color:#a50009!important}.v-application .admin--text.text--darken-2{color:#a50009!important;caret-color:#a50009!important}.v-application .admin.darken-3{background-color:#860000!important;border-color:#860000!important}.v-application .admin--text.text--darken-3{color:#860000!important;caret-color:#860000!important}.v-application .admin.darken-4{background-color:#690000!important;border-color:#690000!important}.v-application .admin--text.text--darken-4{color:#690000!important;caret-color:#690000!important}</style><base href="/data-fair/"><link rel="preload" href="/data-fair/_nuxt/ebd4603b164dbaec4855.js" as="script"><link rel="preload" href="/data-fair/_nuxt/1a796adabe46c4f98449.js" as="script"><link rel="preload" href="/data-fair/_nuxt/c541ecb34a3876dff262.css" as="style"><link rel="preload" href="/data-fair/_nuxt/6592fd1dfe04fbdb2006.js" as="script"><link rel="preload" href="/data-fair/_nuxt/80fde2ea666501a30862.css" as="style"><link rel="preload" href="/data-fair/_nuxt/c30f9de775ea5779b48c.js" as="script"><link rel="preload" href="/data-fair/_nuxt/5b367f745cb1f2263236.css" as="style"><link rel="preload" href="/data-fair/_nuxt/120592ef3be9aab883ee.js" as="script"><link rel="stylesheet" href="/data-fair/_nuxt/c541ecb34a3876dff262.css"><link rel="stylesheet" href="/data-fair/_nuxt/80fde2ea666501a30862.css"><link rel="stylesheet" href="/data-fair/_nuxt/5b367f745cb1f2263236.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light"><div class="v-application--wrap"><header class="v-sheet theme--dark v-toolbar v-app-bar v-app-bar--fixed primary" style="height:56px;margin-top:0;transform:translateY(0);left:0;right:0"><div class="v-toolbar__content" style="height:56px"><div class="logo-container"><a href="/data-fair/" title="Accueil" class="nuxt-link-active"><img src="/data-fair/_nuxt/img/0f9328f.svg" style="max-width:150px;max-height:100%"></a></div> <div class="v-toolbar__title"><h1 class="headline">
        DataFair
      </h1></div> <div class="spacer"></div> <div class="v-toolbar__items"><a href="/data-fair/about/overview" class="v-btn v-btn--flat v-btn--router v-btn--text theme--dark v-size--default"><span class="v-btn__content">
        A propos
      </span></a><a href="/data-fair/install/install" class="v-btn v-btn--flat v-btn--router v-btn--text theme--dark v-size--default"><span class="v-btn__content">
        Installation
      </span></a><a href="/data-fair/interoperate/applications" class="v-btn v-btn--flat v-btn--router v-btn--text theme--dark v-size--default v-btn--active"><span class="v-btn__content">
        Interopérer
      </span></a><a href="/data-fair/user-guide/introduction" class="v-btn v-btn--flat v-btn--router v-btn--text theme--dark v-size--default"><span class="v-btn__content">
        Manuel utilisateur
      </span></a></div> <div class="spacer"></div> <div class="v-speed-dial v-speed-dial--direction-bottom"><button type="button" class="v-btn v-btn--flat v-btn--icon v-btn--round theme--dark v-size--default"><span class="v-btn__content">
          fr
        </span></button><div class="v-speed-dial__list"></div></div></div></header> <main class="v-main v-content" style="padding-top:56px;padding-right:0;padding-bottom:0;padding-left:0"><div class="v-main__wrap v-content__wrap"><div class="container doc-page container--fluid"><nav class="v-navigation-drawer v-navigation-drawer--close v-navigation-drawer--fixed v-navigation-drawer--is-mobile theme--light" style="height:100vh;top:0;transform:translateX(-100%);width:256px;padding-top:64px"><div class="v-navigation-drawer__content"><div class="v-subheader theme--light">Interopérer</div> <div class="v-list v-sheet theme--light"><a href="/data-fair/interoperate/applications" tabindex="0" class="v-list-item v-list-item--link theme--light"><div class="v-list-item__title">Créer des applications</div></a><a href="/data-fair/interoperate/services" tabindex="0" class="v-list-item v-list-item--link theme--light"><div class="v-list-item__title">Créer des services</div></a><a href="/data-fair/interoperate/api" tabindex="0" class="v-list-item--active v-list-item v-list-item--link theme--light"><div class="v-list-item__title">Publier des données par l'API</div></a></div></div><div class="v-navigation-drawer__border"></div></nav> <div class="row"><div class="col"><h2 class="display1 my-4">
        Publier des données par l'API
      </h2> <div cols="12" style="display:none"><section><p>Data FAIR expose un API HTTP complète. Une partie de cette API est essentiellement à destination des applications et autres réutilisations des jeux de données. Une autre partie concerne principalement les producteurs de contenu qui souhaitent automatiser leur processus. Dans cette page nous proposons un aperçu de quelques méthodes de publication de contenu. Les exemples ci-dessous ne montrent qu'un échantillon des capacités de l'API DataFair et ne remplacent pas la documentation interactive bien plus complète embarquée dans le service.</p>
<h3>Pré-requis</h3>
<ul>
<li>Une installation opérationnelle de Data FAIR, soit locale, soit publique comme sur <a href="https://koumoul.com/s/data-fair">koumoul.com</a></li>
<li>Un compte et une clé d'API avec la portée "Gestion des jeux de données" (voir vos paramètres personnels ou d'organisation dans le menu en haut à droite)</li>
<li><a href="https://curl.haxx.se/">curl</a> ou autre client HTTP à condition d'adapter les exemples</li>
</ul>
<p>Définissez une variable contenant votre clé d'API :</p>
<pre><code class="language-sh"><span class="hljs-built_in">export</span> API_KEY=<span class="hljs-string">"XXXX"</span>
</code></pre>
<p>Définissez une variable contenant l'URL de base de votre instance DataFair :</p>
<pre><code class="language-sh"><span class="hljs-built_in">export</span> DATAFAIR_URL=<span class="hljs-string">"https://koumoul.com/s/data-fair"</span>
<span class="hljs-built_in">export</span> DATAFAIR_URL=<span class="hljs-string">"http://localhost/data-fair"</span>
</code></pre>
<h3>Jeu de données simple basé fichier</h3>
<p>Téléchargez un fichier CSV d'exemple :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/<span class="hljs-built_in">test</span>/resources/dataset1.csv -o dataset1.csv
</code></pre>
<p>Créez un jeu de données simple à partir de ce fichier avec une requête HTTP multipart :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --form file=@dataset1.csv <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets
</code></pre>
<p>Notez dans le retour que le jeu de données créé s'est vu attribué un identifiant "id" que vous pouvez conserver pour effectuer des opérations ultérieures sur ce jeu de données.</p>
<pre><code class="language-sh"><span class="hljs-built_in">export</span> DATASET_ID=identifiant que vous venez de recevoir
</code></pre>
<p>L'attribut "status" est à "loaded". Notez que les traitements sur le jeu de données sont exécutés de manière asynchrone, quelques secondes plus tard le statut devrait devenir "finalized" en passant par des étapes intermédiaires. Pour vérifier cela vous pouvez faire un GET sur le jeu de données :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>
</code></pre>
<p>L'attribut page est lui aussi intéressant, il vous permet de naviguer dans un navigateur directement sur la page de description du jeu de données. Pour connaître l'étendue des capacités de requêtage sur ce jeu de données vous pouvez vous rendre sur l'onglet API depuis cette page. Voici un exemple basique :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/lines
</code></pre>
<h3>Jeu de données basé fichier avec pièces jointes</h3>
<p>Téléchargez un fichier CSV d'exemple qui contient une colonne de chemins vers des pièces jointes :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/<span class="hljs-built_in">test</span>/resources/dataset-attachments.csv -o dataset-attachments.csv
</code></pre>
<p>Téléchargez l'archive contenant les pièces jointes correspondantes :</p>
<pre><code class="language-sh">curl https://raw.githubusercontent.com/koumoul-dev/data-fair/master/<span class="hljs-built_in">test</span>/resources/files.zip -o files.zip
</code></pre>
<p>Créez un jeu de données basé sur le CSV et enrichi avec les pièces jointes de l'archive grâce à cette requête HTTP multipart :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --form file=@dataset-attachments.csv --form attachments=@files.zip <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets
<span class="hljs-built_in">export</span> DATASET_ID=identifiant que vous venez de recevoir
</code></pre>
<p>Si vous visitez la page de ce jeu de données vous verrez un onglet "Fichiers" supplémentaire qui permet de lister les pièces jointes et d'effectuer des recherches dans leur contenu. En effectuant une requête basique sur le jeu de données vous pouvez constater l'ajout de champs _file.* qui sont issus de l'analyse du contenu des pièces jointes.</p>
<h3>Jeu de données incrémental</h3>
<p>Créez un jeu de données incrémental vide avec un schéma minimaliste. Notez l'attribut "isRest" qui est la condition pour créer ce type de jeu de données :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --header <span class="hljs-string">"Content-Type: application/json"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets --data <span class="hljs-string">'{
  "isRest": true,
  "title": "rest1",
  "schema": [{ "key": "attr1", "type": "string" }, { "key": "attr2", "type": "string" }]
}'</span>
<span class="hljs-built_in">export</span> DATASET_ID=identifiant que vous venez de recevoir
</code></pre>
<p>Ajouter une ligne de donnée :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --header <span class="hljs-string">"Content-Type: application/json"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/lines --data <span class="hljs-string">'{
  "_id": "ligne1",
  "attr1": "attr1 ligne1",
  "attr2": "attr2 ligne1"
}'</span>
</code></pre>
<p>Ajoutez/modifiez plusieurs lignes de donnée :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --header <span class="hljs-string">"Content-Type: application/json"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/_bulk_lines --data <span class="hljs-string">'[
  { "_id": "ligne1", "_action": "patch", "attr1": "attr1 ligne1 autre valeur"},
  { "_id": "ligne2", "attr1": "attr1 ligne2", "attr2": "attr2 ligne2"}
]'</span>
</code></pre>
<p>Vérifiez la donnée :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/lines
</code></pre>
<h3>Jeu de données incrémental avec pièces jointes</h3>
<p>Créez un jeu de données incrémental vide avec un schéma qui contient un champ type <em>pièces jointes</em> :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> --header <span class="hljs-string">"Content-Type: application/json"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets --data <span class="hljs-string">'{
  "isRest": true,
  "title": "rest1",
  "schema": [
    { "key": "attr1", "type": "string" },
    { "key": "attachmentPath", "type": "string", "x-refersTo": "http://schema.org/DigitalDocument" }
  ]
}'</span>
<span class="hljs-built_in">export</span> DATASET_ID=identifiant que vous venez de recevoir
</code></pre>
<p>Ajoutez plusieurs lignes de données avec pièces jointes dans une archive :</p>
<pre><code class="language-sh"><span class="hljs-built_in">echo</span> <span class="hljs-string">'[
  { "_id": "line1", "attr1": "test1", "attachmentPath": "test.odt" },
  { "_id": "line2", "attr1": "test1", "attachmentPath": "dir1/test.pdf" }
]'</span> > actions.json
curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/_bulk_lines --form attachments=@files.zip --form actions=@actions.json
</code></pre>
<p>Vérifiez la donnée :</p>
<pre><code class="language-sh">curl -v --header <span class="hljs-string">"x-apiKey: <span class="hljs-variable">$API_KEY</span>"</span> <span class="hljs-variable">$DATAFAIR_URL</span>/api/v1/datasets/<span class="hljs-variable">$DATASET_ID</span>/lines
</code></pre>
</section>
</div></div></div></div></div></main> <footer class="v-footer pa-3 v-sheet theme--light"><div class="spacer"></div> <div>Powered by <a href="https://koumoul.com">Koumoul</a></div></footer></div></div></div></div><script>window.__NUXT__=function(n){return{layout:"default",data:[{}],fetch:[],error:null,state:{env:{theme:{dark:!1,colors:{primary:"#1E88E5",secondary:"#42A5F5",accent:"#FF9800",error:"FF5252",info:n,success:"#4CAF50",warning:"#E91E63",admin:"#E53935"},darkColors:{primary:n,success:"#00E676"},cssUrl:null,cssText:"\n.theme--light .navigation-left .v-navigation-drawer__content {\n  background: linear-gradient(90deg, rgba(25,118,210,1) 0%, rgba(30,136,229,1) 100%);\n}\n.theme--dark .navigation-left .v-navigation-drawer__content {\n  background: linear-gradient(90deg, #363636 0%, #272727 100%);\n}\n.v-btn.primary {\n  background: linear-gradient(270deg, rgba(25,118,210,1) 0%, rgba(30,136,229,1) 100%);\n}\n"},publicUrl:"http://localhost:8080"},i18n:{routeParams:{}}},serverRendered:!0,routePath:"/interoperate/api"}}("#2196F3")</script><script src="/data-fair/_nuxt/ebd4603b164dbaec4855.js" defer></script><script src="/data-fair/_nuxt/120592ef3be9aab883ee.js" defer></script><script src="/data-fair/_nuxt/1a796adabe46c4f98449.js" defer></script><script src="/data-fair/_nuxt/6592fd1dfe04fbdb2006.js" defer></script><script src="/data-fair/_nuxt/c30f9de775ea5779b48c.js" defer></script>
  </body>
</html>
